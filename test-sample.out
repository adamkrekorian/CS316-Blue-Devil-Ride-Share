--SQL Queries
--Specific Examples:
--Rides to DC
SELECT *
FROM Ride
WHERE destination = 'Washington, DC' AND origin = 'Durham, NC';
 ride_no |   origin   |  destination   | driver_netid |    date    | earliest_time | latest_time | seats_available | gas_price |          comm$
---------+------------+----------------+--------------+------------+---------------+-------------+-----------------+-----------+--------------$
      46 | Durham, NC | Washington, DC | cas175       | 2020-01-19 | 15:00:00      | 15:20:00    |               4 |           |
      72 | Durham, NC | Washington, DC | mlr87        | 2020-08-30 | 00:00:00      | 23:59:00    |               2 |        60 | no space for $
(2 rows)

--Rides to Charlotte with 2 seats available
SELECT *
FROM Ride
WHERE destination = 'Charlotte, NC' AND origin = 'Durham, NC' AND seats_available >= 2;
 ride_no |   origin   |  destination  | driver_netid |    date    | earliest_time | latest_time | seats_available | gas_price | comments
---------+------------+---------------+--------------+------------+---------------+-------------+-----------------+-----------+----------
      35 | Durham, NC | Charlotte, NC | agk19        | 2020-07-04 | 16:00:00      | 16:15:00    |               6 |        15 |
(1 row)

-- Rides after May 6th leaving in the afternoon
SELECT *
FROM Ride
WHERE origin = 'Durham, NC' AND date > '2020-05-05' AND earliest_time > '12:00:00';
 ride_no |   origin   |   destination    | driver_netid |    date    | earliest_time | latest_time | seats_available | gas_price |            $
---------+------------+------------------+--------------+------------+---------------+-------------+-----------------+-----------+------------$
      35 | Durham, NC | Charlotte, NC    | agk19        | 2020-07-04 | 16:00:00      | 16:15:00    |               6 |        15 |
      36 | Durham, NC | Chicago, IL      | ijs5         | 2020-06-20 | 17:00:00      | 23:40:00    |               2 |           | searching f$
      40 | Durham, NC | New York, NY     | agk19        | 2020-12-25 | 20:00:00      | 23:59:00    |               3 |           | Long drive $
      41 | Durham, NC | Philadelphia, PA | gal16        | 2020-07-07 | 21:00:00      | 21:45:00    |               1 |        50 |
      42 | Durham, NC | Houston, TX      | gal16        | 2020-11-25 | 22:00:00      | 22:50:00    |               1 |       300 | Yeehaw
      47 | Durham, NC | Detroit, MI      | ijs5         | 2020-09-05 | 21:00:00      | 21:45:00    |               1 |       100 | I can drop $
      53 | Durham, NC | Aspen, CO        | cas175       | 2020-06-06 | 14:00:00      | 22:00:00    |               3 |        20 | test
      73 | Durham, NC | New York, NY     | cas175       | 2021-01-01 | 18:00:00      | 19:00:00    |               2 |       100 |
(8 rows)

-- Rides to New York with cheapest gas cost first
SELECT *
FROM Ride
WHERE destination = 'New York, NY' AND origin = 'Durham, NC'
ORDER BY gas_price asc;
 ride_no |   origin   | destination  | driver_netid |    date    | earliest_time | latest_time | seats_available | gas_price |    comments
---------+------------+--------------+--------------+------------+---------------+-------------+-----------------+-----------+-----------------
      55 | Durham, NC | New York, NY | gal16        | 2020-06-08 | 02:00:00      | 03:00:00    |               1 |         5 | Big apple
      73 | Durham, NC | New York, NY | cas175       | 2021-01-01 | 18:00:00      | 19:00:00    |               2 |       100 |
      40 | Durham, NC | New York, NY | agk19        | 2020-12-25 | 20:00:00      | 23:59:00    |               3 |           | Long drive home
(3 rows)

-- Rides from Durham, NC with a Graduate student as a driver
SELECT *
FROM Ride R, rideshare_user U
WHERE R.driver_netid = U.netid AND R.origin = 'Durham, NC' AND U.affiliation = 'Graduate';
 ride_no |   origin   | destination | driver_netid |    date    | earliest_time | latest_time | seats_available | gas_price |               co$
---------+------------+-------------+--------------+------------+---------------+-------------+-----------------+-----------+-----------------$
      36 | Durham, NC | Chicago, IL | ijs5         | 2020-06-20 | 17:00:00      | 23:40:00    |               2 |           | searching for fe$
      47 | Durham, NC | Detroit, MI | ijs5         | 2020-09-05 | 21:00:00      | 21:45:00    |               1 |       100 | I can drop off a$
      44 | Durham, NC | Denver, CO  | ijs5         | 2020-01-08 | 12:00:00      | 12:45:00    |               2 |       250 | Ski trip        $
      69 | Durham, NC | Miami, FL   | mah129       | 2020-11-26 | 09:45:00      | 22:40:00    |               5 |        80 |                 $
      39 | Durham, NC | Raleigh, NC | ijs5         | 2020-02-03 | 19:00:00      | 23:59:00    |               0 |        25 | going to 123 Mai$
(5 rows)

-- Rides from Charlotte to Durham
SELECT *
FROM Ride
WHERE destination = 'Durham, NC' AND origin = 'Charlotte, NC';
 ride_no |    origin     | destination | driver_netid |    date    | earliest_time | latest_time | seats_available | gas_price | comments
---------+---------------+-------------+--------------+------------+---------------+-------------+-----------------+-----------+----------
      26 | Charlotte, NC | Durham, NC  | ijs5         | 2020-10-04 | 09:00:00      | 23:59:00    |               0 |        10 |
(1 row)

-- Rides from Durham to Philadelphia sorted by earliest departure
SELECT *
FROM Ride
WHERE destination = 'Philadelphia, PA' AND origin = 'Durham, NC'
ORDER BY earliest_time asc;
 ride_no |   origin   |   destination    | driver_netid |    date    | earliest_time | latest_time | seats_available | gas_price | comments
---------+------------+------------------+--------------+------------+---------------+-------------+-----------------+-----------+----------
      41 | Durham, NC | Philadelphia, PA | gal16        | 2020-07-07 | 21:00:00      | 21:45:00    |               1 |        50 |
(1 row)

-- Rides with one seat available
SELECT *
FROM Ride
WHERE seats_available = 1;
 ride_no |      origin       |   destination    | driver_netid |    date    | earliest_time | latest_time | seats_available | gas_price |     $
---------+-------------------+------------------+--------------+------------+---------------+-------------+-----------------+-----------+-----$
      16 | San Francisco, CA | Durham, NC       | ijs5         | 2020-01-02 | 00:00:00      | 23:59:59    |               1 |       200 | join$
      23 | Detroit, MI       | Durham, NC       | agk19        | 2020-02-14 | 06:00:00      | 06:01:00    |               1 |        50 | goin$
      25 | Los Angeles, CA   | Durham, NC       | agk19        | 2020-08-22 | 08:00:00      | 10:00:00    |               1 |       200 | long$
      41 | Durham, NC        | Philadelphia, PA | gal16        | 2020-07-07 | 21:00:00      | 21:45:00    |               1 |        50 |
      42 | Durham, NC        | Houston, TX      | gal16        | 2020-11-25 | 22:00:00      | 22:50:00    |               1 |       300 | Yeeh$
      43 | Durham, NC        | Phoenix, AZ      | mjb128       | 2020-01-06 | 23:00:00      | 23:10:00    |               1 |       250 | Road$
      47 | Durham, NC        | Detroit, MI      | ijs5         | 2020-09-05 | 21:00:00      | 21:45:00    |               1 |       100 | I ca$
      28 | Miami, FL         | Durham, NC       | cas175       | 2020-08-20 | 11:00:00      | 13:30:00    |               1 |           | brin$
      21 | New York, NY      | Durham, NC       | gal16        | 2020-01-10 | 05:00:00      | 20:00:00    |               1 |           | good$
      64 | Durham, NC        | Myrtle Beach, SC | gal16        | 2020-06-24 | 09:00:00      | 21:00:00    |               1 |        23 | comm$
      67 | Washington, DC    | Durham, NC       | mlr87        | 2020-08-20 | 08:15:00      | 09:45:00    |               1 |      20.5 | away$
      55 | Durham, NC        | New York, NY     | gal16        | 2020-06-08 | 02:00:00      | 03:00:00    |               1 |         5 | Big $
      58 | High Point, NC    | Fresno, CA       | gal16        | 2020-06-11 | 03:00:00      | 21:00:00    |               1 |        20 | Fav $
      59 | Baltimore, MD     | Boca Grande, FL  | gal16        | 2020-06-13 | 04:00:00      | 20:00:00    |               1 |        30 |
(14 rows)

-- Rides to Durham with a Undergraduate student as a driver ordered by most seats available
SELECT *
FROM Ride R, rideshare_user U
WHERE R.driver_netid = U.netid AND R.destination = 'Durham, NC' AND U.affiliation = 'Undergraduate'
ORDER BY R.seats_available desc;
 ride_no |      origin      | destination | driver_netid |    date    | earliest_time | latest_time | seats_available | gas_price |           $
---------+------------------+-------------+--------------+------------+---------------+-------------+-----------------+-----------+-----------$
      32 | Washington, DC   | Durham, NC  | mjb128       | 2020-03-29 | 14:00:00      | 15:00:00    |               5 |        50 |           $
      19 | Raleigh, NC      | Durham, NC  | mjb128       | 2020-01-01 | 03:00:00      | 08:00:00    |               5 |         5 | do not hav$
      24 | Myrtle Beach, SC | Durham, NC  | agk19        | 2020-05-01 | 07:00:00      | 07:45:00    |               4 |        25 | yay       $
      65 | Myrtle Beach, SC | Durham, NC  | gal16        | 2020-06-30 | 10:00:00      | 20:00:00    |               4 |        30 | beach week$
      52 | Asheville, NC    | Durham, NC  | cas175       | 2020-05-20 | 17:30:00      | 18:30:00    |               4 |           |           $
      20 | Dallas, TX       | Durham, NC  | gal16        | 2020-01-02 | 04:00:00      | 04:30:00    |               3 |        75 | need someo$
      78 | Baltimore, MD    | Durham, NC  | afk11        | 2021-05-08 | 11:00:00      | 12:00:00    |               3 |        20 |           $
      17 | New York, NY     | Durham, NC  | mjb128       | 2020-01-02 | 00:01:00      | 23:59:00    |               2 |        50 | going to 3$
      29 | Raleigh, NC      | Durham, NC  | cas175       | 2020-05-01 | 12:00:00      | 13:05:00    |               2 |           |           $
      18 | New York, NY     | Durham, NC  | mjb128       | 2020-01-03 | 02:00:00      | 05:00:00    |               2 |        75 | no pets pl$
      68 | Asheville, NC    | Durham, NC  | srj99        | 2020-08-30 | 20:30:00      | 23:59:00    |               2 |        60 | going home$
      21 | New York, NY     | Durham, NC  | gal16        | 2020-01-10 | 05:00:00      | 20:00:00    |               1 |           | good singe$
      28 | Miami, FL        | Durham, NC  | cas175       | 2020-08-20 | 11:00:00      | 13:30:00    |               1 |           | bring your$
      25 | Los Angeles, CA  | Durham, NC  | agk19        | 2020-08-22 | 08:00:00      | 10:00:00    |               1 |       200 | long ride,$
      67 | Washington, DC   | Durham, NC  | mlr87        | 2020-08-20 | 08:15:00      | 09:45:00    |               1 |      20.5 | away forma$
      23 | Detroit, MI      | Durham, NC  | agk19        | 2020-02-14 | 06:00:00      | 06:01:00    |               1 |        50 | going to 2$
      54 | Aspen, CO        | Durham, NC  | gal16        | 2020-06-07 | 14:00:00      | 21:00:00    |               0 |        10 |           $
      30 | Seattle, WA      | Durham, NC  | cas175       | 2020-04-20 | 13:00:00      | 15:30:00    |               0 |       300 | bad weathe$
      56 | New York, NY     | Durham, NC  | gal16        | 2020-06-25 | 01:00:00      | 21:00:00    |               0 |        70 | Lots of to$
(19 rows)

-- Rides after May 4th leaving no later than 7 pm
SELECT *
FROM Ride
WHERE date > '2020-05-04' AND latest_time < '19:00:00';
 ride_no |     origin      |  destination   | driver_netid |    date    | earliest_time | latest_time | seats_available | gas_price |         $
---------+-----------------+----------------+--------------+------------+---------------+-------------+-----------------+-----------+---------$
      25 | Los Angeles, CA | Durham, NC     | agk19        | 2020-08-22 | 08:00:00      | 10:00:00    |               1 |       200 | long rid$
      27 | Denver, CO      | Durham, NC     | ijs5         | 2020-12-24 | 10:00:00      | 10:15:00    |               3 |        75 | no pets $
      34 | Durham, NC      | Miami, FL      | mjb128       | 2020-05-05 | 15:00:00      | 15:01:00    |               5 |       100 | to sunni$
      35 | Durham, NC      | Charlotte, NC  | agk19        | 2020-07-04 | 16:00:00      | 16:15:00    |               6 |        15 |
      49 | Durham, NC      | Nashville, TN  | mjb128       | 2020-11-04 | 00:00:00      | 12:00:00    |               2 |        60 | Searchin$
      28 | Miami, FL       | Durham, NC     | cas175       | 2020-08-20 | 11:00:00      | 13:30:00    |               1 |           | bring yo$
      52 | Asheville, NC   | Durham, NC     | cas175       | 2020-05-20 | 17:30:00      | 18:30:00    |               4 |           |
      67 | Washington, DC  | Durham, NC     | mlr87        | 2020-08-20 | 08:15:00      | 09:45:00    |               1 |      20.5 | away for$
      55 | Durham, NC      | New York, NY   | gal16        | 2020-06-08 | 02:00:00      | 03:00:00    |               1 |         5 | Big apple
      76 | Miami, FL       | Washington, DC | ls320        | 2020-05-08 | 09:00:00      | 12:00:00    |               3 |        20 |
      78 | Baltimore, MD   | Durham, NC     | afk11        | 2021-05-08 | 11:00:00      | 12:00:00    |               3 |        20 |
      79 | Durham, NC      | Asheville, NC  | afk11        | 2021-04-22 | 09:00:00      | 12:00:00    |               3 |        20 |
(12 rows)
