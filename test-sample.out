--SQL Queries
--Specific Examples:
--Rides to DC
SELECT *
FROM Ride
WHERE destination = 'Washington, DC' AND origin = 'Durham, NC';
 ride_no |   origin   |  destination   | driver_netid |    date    | earliest_time | latest_time | seats_available | gas_price |          comments
---------+------------+----------------+--------------+------------+---------------+-------------+-----------------+-----------+----------------------------
      46 | Durham, NC | Washington, DC | cas175       | 2020-01-19 | 15:00:00      | 15:20:00    |               4 |           |
      72 | Durham, NC | Washington, DC | mlr87        | 2020-08-30 | 00:00:00      | 23:59:00    |               2 |        60 | no space for extra luggage
(2 rows)

--Rides to Charlotte with 2 seats available
SELECT *
FROM Ride
WHERE destination = 'Charlotte, NC' AND origin = 'Durham, NC' AND seats_available >= 2;
 ride_no |   origin   |  destination  | driver_netid |    date    | earliest_time | latest_time | seats_available | gas_price | comments
---------+------------+---------------+--------------+------------+---------------+-------------+-----------------+-----------+----------
      35 | Durham, NC | Charlotte, NC | agk19        | 2020-07-04 | 16:00:00      | 16:15:00    |               6 |        15 |
(1 row)

-- Rides after May 6th leaving in the afternoon
SELECT *
FROM Ride
WHERE origin = 'Durham, NC' AND date > '2020-05-05' AND earliest_time > '12:00:00';
 ride_no |   origin   |   destination    | driver_netid |    date    | earliest_time | latest_time | seats_available | gas_price |               comments
---------+------------+------------------+--------------+------------+---------------+-------------+-----------------+-----------+---------------------------------------
      35 | Durham, NC | Charlotte, NC    | agk19        | 2020-07-04 | 16:00:00      | 16:15:00    |               6 |        15 |
      36 | Durham, NC | Chicago, IL      | ijs5         | 2020-06-20 | 17:00:00      | 23:40:00    |               2 |           | searching for fellow deep dish lovers
      40 | Durham, NC | New York, NY     | agk19        | 2020-12-25 | 20:00:00      | 23:59:00    |               3 |           | Long drive home
      41 | Durham, NC | Philadelphia, PA | gal16        | 2020-07-07 | 21:00:00      | 21:45:00    |               1 |        50 |
      42 | Durham, NC | Houston, TX      | gal16        | 2020-11-25 | 22:00:00      | 22:50:00    |               1 |       300 | Yeehaw
      47 | Durham, NC | Detroit, MI      | ijs5         | 2020-09-05 | 21:00:00      | 21:45:00    |               1 |       100 | I can drop off at the Motown Museum
      53 | Durham, NC | Aspen, CO        | cas175       | 2020-06-06 | 14:00:00      | 22:00:00    |               3 |        20 | test
      73 | Durham, NC | New York, NY     | cas175       | 2021-01-01 | 18:00:00      | 19:00:00    |               2 |       100 |
(8 rows)

-- Rides to New York with cheapest gas cost first
SELECT *
FROM Ride
WHERE destination = 'New York, NY' AND origin = 'Durham, NC'
ORDER BY gas_price asc;
 ride_no |   origin   | destination  | driver_netid |    date    | earliest_time | latest_time | seats_available | gas_price |    comments
---------+------------+--------------+--------------+------------+---------------+-------------+-----------------+-----------+-----------------
      55 | Durham, NC | New York, NY | gal16        | 2020-06-08 | 02:00:00      | 03:00:00    |               1 |         5 | Big apple
      73 | Durham, NC | New York, NY | cas175       | 2021-01-01 | 18:00:00      | 19:00:00    |               2 |       100 |
      40 | Durham, NC | New York, NY | agk19        | 2020-12-25 | 20:00:00      | 23:59:00    |               3 |           | Long drive home
(3 rows)

-- Rides from Durham, NC with a Graduate student as a driver
SELECT *
FROM Ride R, rideshare_user U
WHERE R.driver_netid = U.netid AND R.origin = 'Durham, NC' AND U.affiliation = 'Graduate';
 ride_no |   origin   | destination | driver_netid |    date    | earliest_time | latest_time | seats_available | gas_price |               comments                | netid  |   $
---------+------------+-------------+--------------+------------+---------------+-------------+-----------------+-----------+---------------------------------------+--------+---$
      36 | Durham, NC | Chicago, IL | ijs5         | 2020-06-20 | 17:00:00      | 23:40:00    |               2 |           | searching for fellow deep dish lovers | ijs5   | Is$
      47 | Durham, NC | Detroit, MI | ijs5         | 2020-09-05 | 21:00:00      | 21:45:00    |               1 |       100 | I can drop off at the Motown Museum   | ijs5   | Is$
      44 | Durham, NC | Denver, CO  | ijs5         | 2020-01-08 | 12:00:00      | 12:45:00    |               2 |       250 | Ski trip                              | ijs5   | Is$
      69 | Durham, NC | Miami, FL   | mah129       | 2020-11-26 | 09:45:00      | 22:40:00    |               5 |        80 |                                       | mah129 | Ma$
      39 | Durham, NC | Raleigh, NC | ijs5         | 2020-02-03 | 19:00:00      | 23:59:00    |               0 |        25 | going to 123 Main Street              | ijs5   | Is$
(5 rows)

-- Rides from Charlotte to Durham
SELECT *
FROM Ride
WHERE destination = 'Durham, NC' AND origin = 'Charlotte, NC';
 ride_no |    origin     | destination | driver_netid |    date    | earliest_time | latest_time | seats_available | gas_price | comments
---------+---------------+-------------+--------------+------------+---------------+-------------+-----------------+-----------+----------
      26 | Charlotte, NC | Durham, NC  | ijs5         | 2020-10-04 | 09:00:00      | 23:59:00    |               0 |        10 |
(1 row)

-- Rides from Durham to Philadelphia sorted by earliest departure
SELECT *
FROM Ride
WHERE destination = 'Philadelphia, PA' AND origin = 'Durham, NC'
ORDER BY earliest_time asc;
 ride_no |   origin   |   destination    | driver_netid |    date    | earliest_time | latest_time | seats_available | gas_price | comments
---------+------------+------------------+--------------+------------+---------------+-------------+-----------------+-----------+----------
      41 | Durham, NC | Philadelphia, PA | gal16        | 2020-07-07 | 21:00:00      | 21:45:00    |               1 |        50 |
(1 row)

-- Rides with one seat available
SELECT *
FROM Ride
WHERE seats_available = 1;
 ride_no |      origin       |   destination    | driver_netid |    date    | earliest_time | latest_time | seats_available | gas_price |              comments
---------+-------------------+------------------+--------------+------------+---------------+-------------+-----------------+-----------+-------------------------------------
      16 | San Francisco, CA | Durham, NC       | ijs5         | 2020-01-02 | 00:00:00      | 23:59:59    |               1 |       200 | join me on a road trip!
      23 | Detroit, MI       | Durham, NC       | agk19        | 2020-02-14 | 06:00:00      | 06:01:00    |               1 |        50 | going to 2636 McAlpine
      25 | Los Angeles, CA   | Durham, NC       | agk19        | 2020-08-22 | 08:00:00      | 10:00:00    |               1 |       200 | long ride, need help
      41 | Durham, NC        | Philadelphia, PA | gal16        | 2020-07-07 | 21:00:00      | 21:45:00    |               1 |        50 |
      42 | Durham, NC        | Houston, TX      | gal16        | 2020-11-25 | 22:00:00      | 22:50:00    |               1 |       300 | Yeehaw
      43 | Durham, NC        | Phoenix, AZ      | mjb128       | 2020-01-06 | 23:00:00      | 23:10:00    |               1 |       250 | Road trip
      47 | Durham, NC        | Detroit, MI      | ijs5         | 2020-09-05 | 21:00:00      | 21:45:00    |               1 |       100 | I can drop off at the Motown Museum
      28 | Miami, FL         | Durham, NC       | cas175       | 2020-08-20 | 11:00:00      | 13:30:00    |               1 |           | bring your swimsuit
      21 | New York, NY      | Durham, NC       | gal16        | 2020-01-10 | 05:00:00      | 20:00:00    |               1 |           | good singers only
      64 | Durham, NC        | Myrtle Beach, SC | gal16        | 2020-06-24 | 09:00:00      | 21:00:00    |               1 |        23 | comment
      67 | Washington, DC    | Durham, NC       | mlr87        | 2020-08-20 | 08:15:00      | 09:45:00    |               1 |      20.5 | away formal
      55 | Durham, NC        | New York, NY     | gal16        | 2020-06-08 | 02:00:00      | 03:00:00    |               1 |         5 | Big apple
      58 | High Point, NC    | Fresno, CA       | gal16        | 2020-06-11 | 03:00:00      | 21:00:00    |               1 |        20 | Fav place?
      59 | Baltimore, MD     | Boca Grande, FL  | gal16        | 2020-06-13 | 04:00:00      | 20:00:00    |               1 |        30 |
(14 rows)


-- Rides to New Orleans with a Undergraduate student as a driver ordered by most seats available
SELECT *
FROM Ride R, rideshare_user U
WHERE R.driver_netid = U.netid AND R.destination = 'New Orleans, LA' AND R.origin = 'Durham, NC' AND U.affiliation = 'Undergraduate'
ORDER BY R.seats_available desc;
 ride_no | origin | destination | driver_netid | date | earliest_time | latest_time | seats_available | gas_price | comments | netid | name | duke_email | phone_number | affilia$
---------+--------+-------------+--------------+------+---------------+-------------+-----------------+-----------+----------+-------+------+------------+--------------+--------$
(0 rows)

-- Rides to Miami after May 4th leaving no late than 7 pm
SELECT *
FROM Ride
WHERE destination = 'Miami, FL' AND origin = 'Durham, NC' AND date > '2020-05-04' AND latest_time < '19:00:00';
 ride_no |   origin   | destination | driver_netid |    date    | earliest_time | latest_time | seats_available | gas_price |    comments
---------+------------+-------------+--------------+------------+---------------+-------------+-----------------+-----------+-----------------
      34 | Durham, NC | Miami, FL   | mjb128       | 2020-05-05 | 15:00:00      | 15:01:00    |               5 |       100 | to sunnier days
(1 row)
